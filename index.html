    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    employees: Array.from({length: 4}, (_, i) => ({ name: `à¸žà¸™à¸±à¸à¸‡à¸²à¸™ ${i + 1}` })),
                    taskSets: [
                        { id: 1, rawInput: "55 20 14 16 12 8 90", tasks: [] },
                        { id: 2, rawInput: "6 27 20 28 39", tasks: [] },
                    ],
                    distributedResults: [],
                    // Color Palette
                    colors: [
                        { bg: 'bg-red-100', text: 'text-red-800', border: 'border-red-200', dot: 'bg-red-500' },
                        { bg: 'bg-orange-100', text: 'text-orange-800', border: 'border-orange-200', dot: 'bg-orange-500' },
                        { bg: 'bg-blue-100', text: 'text-blue-800', border: 'border-blue-200', dot: 'bg-blue-500' },
                        { bg: 'bg-emerald-100', text: 'text-emerald-800', border: 'border-emerald-200', dot: 'bg-emerald-500' },
                        { bg: 'bg-purple-100', text: 'text-purple-800', border: 'border-purple-200', dot: 'bg-purple-500' },
                        { bg: 'bg-pink-100', text: 'text-pink-800', border: 'border-pink-200', dot: 'bg-pink-500' },
                        { bg: 'bg-cyan-100', text: 'text-cyan-800', border: 'border-cyan-200', dot: 'bg-cyan-500' },
                    ]
                }
            },
            computed: {
                grandTotalWeight() {
                    return this.distributedResults.reduce((sum, res) => sum + res.totalWeight, 0);
                },
                grandTotalItems() {
                    return this.distributedResults.reduce((sum, res) => sum + res.tasks.length, 0);
                }
            },
            methods: {
                // --- Management ---
                addEmployee() {
                    this.employees.push({ name: `à¸žà¸™à¸±à¸à¸‡à¸²à¸™ ${this.employees.length + 1}` });
                },
                removeEmployee(index) {
                    if (this.employees.length > 0) this.employees.splice(index, 1);
                },
                resetEmployees() {
                    if(confirm('à¸¥à¹‰à¸²à¸‡à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”?')) this.employees = [];
                },
                addTaskSet() {
                    this.taskSets.push({ id: Date.now(), rawInput: "", tasks: [] });
                },
                removeTaskSet(index) {
                    this.taskSets.splice(index, 1);
                },
                resetTaskSets() {
                     if(confirm('à¸¥à¹‰à¸²à¸‡à¸Šà¸¸à¸”à¸‡à¸²à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”?')) this.taskSets = [{ id: Date.now(), rawInput: "", tasks: [] }];
                },

                // --- Styling Helper ---
                getStyle(index) {
                    return this.colors[index % this.colors.length];
                },
                getBadgeColor(index) {
                    const style = this.getStyle(index);
                    return `${style.bg} ${style.text} ${style.border}`;
                },
                getDotColor(index) {
                    return this.getStyle(index).dot;
                },

                // --- Core Logic ---
                parseInput(raw) {
                    const numbers = raw.match(/-?\d+(\.\d+)?/g);
                    return numbers ? numbers.map(Number) : [];
                },

                calculateDistribution() {
                    if (this.employees.length === 0) {
                        alert("à¸à¸£à¸¸à¸“à¸²à¹€à¸žà¸´à¹ˆà¸¡à¸žà¸™à¸±à¸à¸‡à¸²à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 1 à¸„à¸™");
                        return;
                    }

                    // 1. Prepare Employee Buckets
                    let buckets = this.employees.map(e => ({
                        name: e.name,
                        tasks: [],
                        totalWeight: 0
                    }));

                    // 2. Process Task Sets
                    this.taskSets.forEach((set, setIndex) => {
                        const tasks = this.parseInput(set.rawInput);
                        tasks.sort((a, b) => b - a);

                        tasks.forEach(taskValue => {
                            let minIndex = 0;
                            let minWeight = buckets[0].totalWeight;

                            for (let i = 1; i < buckets.length; i++) {
                                if (buckets[i].totalWeight < minWeight) {
                                    minWeight = buckets[i].totalWeight;
                                    minIndex = i;
                                }
                            }

                            buckets[minIndex].tasks.push({
                                value: taskValue,
                                originalSetIndex: setIndex
                            });
                            buckets[minIndex].totalWeight += taskValue;
                        });
                    });

                    // 3. Post-process
                    buckets.forEach(bucket => {
                        bucket.tasks.sort((a, b) => {
                            if (a.originalSetIndex !== b.originalSetIndex) {
                                return a.originalSetIndex - b.originalSetIndex;
                            }
                            return b.value - a.value;
                        });
                    });

                    this.distributedResults = buckets.map(b => ({
                        employeeName: b.name,
                        tasks: b.tasks,
                        totalWeight: parseFloat(b.totalWeight.toFixed(2))
                    }));
                },

                // --- Exports ---
                copyText() {
                    let text = `à¸ªà¸£à¸¸à¸›à¸à¸²à¸£à¹à¸šà¹ˆà¸‡à¸‡à¸²à¸™ (${new Date().toLocaleDateString()})\n\n`;
                    this.distributedResults.forEach(res => {
                        text += `ðŸ‘¤ ${res.employeeName} [à¸£à¸§à¸¡: ${res.totalWeight}]\n`;
                        const tasksStr = res.tasks.map(t => `${t.value}`).join(", ");
                        text += `   à¸‡à¸²à¸™: ${tasksStr}\n\n`;
                    });
                    navigator.clipboard.writeText(text).then(() => alert("à¸„à¸±à¸”à¸¥à¸­à¸à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢!"));
                },

                exportToExcel() {
                    let data = [];
                    let maxTasks = 0;
                    this.distributedResults.forEach(res => {
                        if (res.tasks.length > maxTasks) maxTasks = res.tasks.length;
                        let row = {
                            "à¸Šà¸·à¹ˆà¸­à¸žà¸™à¸±à¸à¸‡à¸²à¸™": res.employeeName,
                            "à¸™à¹‰à¸³à¸«à¸™à¸±à¸à¸£à¸§à¸¡": res.totalWeight,
                            "à¸ˆà¸³à¸™à¸§à¸™à¸Šà¸´à¹‰à¸™": res.tasks.length
                        };
                        res.tasks.forEach((t, i) => {
                            row[`à¸‡à¸²à¸™à¸—à¸µà¹ˆ ${i+1}`] = t.value;
                            row[`à¸Šà¸¸à¸”à¸‡à¸²à¸™ ${i+1}`] = t.originalSetIndex + 1;
                        });
                        data.push(row);
                    });
                    const ws = XLSX.utils.json_to_sheet(data);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "Work_Distribution");
                    XLSX.writeFile(wb, `Distribution_${new Date().toISOString().slice(0,10)}.xlsx`);
                },

                exportToImage() {
                    const element = document.getElementById('export-area');
                    const originalStyle = element.style.cssText;
                    element.style.backgroundColor = "white";
                    
                    html2canvas(element, { scale: 2 }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'distribution_summary.png';
                        link.href = canvas.toDataURL();
                        link.click();
                        element.style.cssText = originalStyle;
                    });
                },

                exportToPDF() {
                    const element = document.getElementById('export-area');
                    const opt = {
                        margin:       0.2,
                        filename:     'work_distribution.pdf',
                        image:        { type: 'jpeg', quality: 0.98 },
                        html2canvas:  { scale: 2, useCORS: true },
                        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
                    };
                    html2pdf().set(opt).from(element).save();
                }
            }
        }).mount('#app');
    </script>
