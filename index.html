<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÉ‡∏ö‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (BY SHU ST) + Alipay Plus</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; -webkit-font-smoothing: antialiased; }
        
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Print Style - ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Template ‡∏Ç‡∏≤‡∏ß‡∏î‡∏≥ */
        @media print {
            @page { size: A4; margin: 0; }
            body { background: white; -webkit-print-color-adjust: exact; }
            #main-app-ui { display: none !important; } /* ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Input */
            #document-template { 
                display: block !important; /* ‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ */
                position: relative !important; 
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                height: auto !important;
                margin: 0 auto !important;
                padding: 20px !important;
            }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="root"></div>

       <script type="text/babel">
        const { useState, useEffect } = React;

        // ... (‡∏™‡πà‡∏ß‡∏ô Icons ‡πÅ‡∏•‡∏∞ Component ‡∏¢‡πà‡∏≠‡∏¢ DenomRow, DocDenomRow ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) ...
        // ‡∏ú‡∏°‡∏Ç‡∏≠‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô Icons ‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö

        // --- Icons ---
        const IconPrinter = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>;
        const IconRefresh = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg>;
        const IconCopy = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>;
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>;
        const IconExcel = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M8 13h2"></path><path d="M8 17h2"></path><path d="M14 13h2"></path><path d="M14 17h2"></path></svg>;
        const IconImage = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>;
        
        const blockInvalidChar = (e) => ['e', 'E', '+', '-'].includes(e.key) && e.preventDefault();
        const formatCurrency = (num) => new Intl.NumberFormat('th-TH', { style: 'decimal', minimumFractionDigits: 2 }).format(num);

        const DenomRow = ({ label, qtyName, qtyValue, amount, onChange }) => (
            <div className="grid grid-cols-12 gap-2 items-center py-1 border-b border-gray-100 text-sm hover:bg-gray-50 transition-colors">
                <div className="col-span-3 font-semibold text-gray-700">{label}</div>
                <div className="col-span-4">
                    <input type="number" min="0" name={qtyName} value={qtyValue} onChange={onChange} onKeyDown={blockInvalidChar} placeholder="0" className="w-full h-8 p-1 border border-gray-300 rounded text-center focus:border-blue-500 outline-none transition-colors focus:ring-2 focus:ring-blue-100 bg-white" />
                </div>
                <div className="col-span-5 text-right font-mono text-gray-900 bg-gray-50 p-1 rounded">
                    {formatCurrency(amount)}
                </div>
            </div>
        );

        const DocDenomRow = ({ label, qty, amount }) => (
            <div className="flex items-center justify-between py-1 border-b border-gray-200 last:border-0 h-9">
                <div className="w-12 font-bold text-gray-800">{label}</div>
                <div className="flex-1 flex gap-2 items-center justify-end">
                    <div className="w-16 h-7 border border-gray-300 rounded flex items-center justify-center text-gray-600 bg-white text-sm">
                        {qty || 0}
                    </div>
                    <div className="w-24 text-right font-mono font-bold text-gray-900 text-sm">
                        {formatCurrency(amount)}
                    </div>
                </div>
            </div>
        );

        function App() {
            // [MODIFIED] ‡πÄ‡∏û‡∏¥‡πà‡∏° expenses ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô State
            const initialState = {
                branch: '', date: new Date().toISOString().split('T')[0],
                time: new Date().toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' }),
                returnWrongKey: '', totalSale: '', expenses: '', // <--- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                creditCard: '', debit: '', wechat: '', alipay: '', 'alipay+': '',
                qty1000: '', qty500: '', qty100: '', qty50: '', qty20: '', 
                qty10: '', qty5: '', qty2: '', qty1: '', 
                recipient: '', note: ''
                // ‡πÄ‡∏≠‡∏≤ cashPos ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å state ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ó‡∏ô
            };

            const [formData, setFormData] = useState(initialState);
            const [calculations, setCalculations] = useState({ 
                totalCashReal: 0, 
                expectedCash: 0, // <--- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å CashPOS ‡πÄ‡∏õ‡πá‡∏ô ExpectedCash
                overShort: 0, 
                breakdown: {} 
            });
            const [copied, setCopied] = useState(false);
            const [isGeneratingImg, setIsGeneratingImg] = useState(false);
            const [isLoaded, setIsLoaded] = useState(false);

            useEffect(() => {
                const savedData = localStorage.getItem('cashDrawerDoc_v2'); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ key ‡πÄ‡∏õ‡πá‡∏ô v2 ‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ï‡∏µ‡∏Å‡∏±‡∏ô
                if (savedData) try { setFormData(JSON.parse(savedData)); } catch (e) {}
                setIsLoaded(true);
            }, []);

            useEffect(() => {
                if (isLoaded) localStorage.setItem('cashDrawerDoc_v2', JSON.stringify(formData));
            }, [formData, isLoaded]);

            // [MODIFIED] ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
            useEffect(() => {
                const parse = (val) => parseFloat(val) || 0;
                const safeFloat = (num) => Math.round(num * 100) / 100;

                // 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏à‡∏£‡∏¥‡∏á (‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ)
                const breakdown = {
                    amt1000: safeFloat(parse(formData.qty1000) * 1000), amt500: safeFloat(parse(formData.qty500) * 500),
                    amt100: safeFloat(parse(formData.qty100) * 100), amt50: safeFloat(parse(formData.qty50) * 50),
                    amt20: safeFloat(parse(formData.qty20) * 20), amt10: safeFloat(parse(formData.qty10) * 10),
                    amt5: safeFloat(parse(formData.qty5) * 5), amt2: safeFloat(parse(formData.qty2) * 2),
                    amt1: safeFloat(parse(formData.qty1) * 1),
                };
                const totalCashReal = safeFloat(Object.values(breakdown).reduce((a, b) => a + b, 0));

                // 2. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (Expected Cash)
                const totalSale = parse(formData.totalSale);
                const deductions = parse(formData.creditCard) + parse(formData.debit) + parse(formData.wechat) + parse(formData.alipay) + parse(formData['alipay+']);
                const expenses = parse(formData.expenses); // ‡∏´‡∏±‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
                const returns = parse(formData.returnWrongKey); // ‡∏´‡∏±‡∏Å‡∏¢‡∏≠‡∏î‡∏Ñ‡∏∑‡∏ô/‡∏Ñ‡∏µ‡∏¢‡πå‡∏ú‡∏¥‡∏î

                // ‡∏™‡∏π‡∏ï‡∏£: ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ = ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° - ‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô/‡∏ö‡∏±‡∏ï‡∏£ - ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å/‡∏Ñ‡∏∑‡∏ô
                // (Note: returnWrongKey ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á POS ‡∏´‡∏±‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á ‡∏ñ‡πâ‡∏≤ Slip ‡∏£‡∏ß‡∏°‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏±‡∏Å‡∏≠‡∏≠‡∏Å)
                // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤ Total Sale ‡πÉ‡∏ô Slip ‡∏Ñ‡∏∑‡∏≠‡∏¢‡∏≠‡∏î‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
                const expectedCash = safeFloat(totalSale - deductions - expenses - returns);

                // 3. ‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á
                const overShort = safeFloat(totalCashReal - expectedCash);

                setCalculations({ totalCashReal, expectedCash, overShort, breakdown });
            }, [formData]);

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };
            
            // ... (functions handlePrint, handleSaveImage ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡πÅ‡∏Å‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢) ...
            const handlePrint = () => window.print();

            const handleSaveImage = async () => {
                setIsGeneratingImg(true);
                await new Promise(r => setTimeout(r, 200));
                try {
                    const element = document.getElementById('document-template');
                    element.style.display = 'block';
                    const canvas = await html2canvas(element, { scale: 2.5, backgroundColor: "#ffffff", logging: false, windowWidth: 800 });
                    element.style.display = 'none';
                    const link = document.createElement('a');
                    link.download = `Cash_${formData.date}_${formData.branch}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) { alert("Error: " + err); }
                setIsGeneratingImg(false);
            };

            const handleExportCSV = () => {
                 const bom = "\uFEFF"; 
                 const csvContent = [
                     ["Branch", formData.branch], ["Date", formData.date], 
                     ["Total Sale", formData.totalSale], ["Expected Cash", calculations.expectedCash],
                     ["Total Cash Real", calculations.totalCashReal], ["Over/Short", calculations.overShort]
                 ].map(e => e.join(",")).join("\n");
                 const blob = new Blob([bom + csvContent], { type: 'text/csv;charset=utf-8;' });
                 const link = document.createElement("a");
                 link.href = URL.createObjectURL(blob);
                 link.download = `Report_${formData.date}.csv`;
                 document.body.appendChild(link);
                 link.click();
                 document.body.removeChild(link);
            };

            const handleCopyText = () => {
                const text = `üõí *Cash Report*\nüìç ${formData.branch} (${formData.date})\nüí∞ Sale: ${formData.totalSale}\nüí∏ Exp: ${formData.expenses}\nüíµ Real: ${calculations.totalCashReal}\nüéØ Target: ${calculations.expectedCash}\n${calculations.overShort > 0 ? '‚úÖ Over: +' : calculations.overShort < 0 ? '‚ùå Short: ' : '‚öñÔ∏è '}${calculations.overShort}`;
                navigator.clipboard.writeText(text);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const handleReset = () => {
                if(window.confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
                    localStorage.removeItem('cashDrawerDoc_v2');
                    setFormData(initialState);
                }
            };

            if (!isLoaded) return <div className="p-10 text-center">Loading...</div>;

            const paymentMethods = ['Credit Card', 'Debit Card', 'WeChat', 'Alipay', 'Alipay+'];

            return (
                <div className="min-h-screen bg-gray-100 flex flex-col items-center py-8">
                    {/* UI ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö Input */}
                    <div id="main-app-ui" className="w-full max-w-3xl px-4">
                        {/* Header Buttons ... */}
                        <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
                            <div>
                                <h1 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                    ‡πÉ‡∏ö‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î <span className="text-sm font-normal text-gray-400">| Daily Cash (Auto-Calc)</span>
                                </h1>
                            </div>
                            <div className="flex flex-wrap gap-2">
                                <button onClick={handleReset} className="btn-action bg-gray-100 px-3 py-2 rounded-lg text-sm"><IconRefresh /> Reset</button>
                                <button onClick={handleCopyText} className="btn-action bg-indigo-50 text-indigo-700 px-3 py-2 rounded-lg text-sm">{copied ? <IconCheck /> : <IconCopy />} Text</button>
                                <button onClick={handleExportCSV} className="btn-action bg-green-50 text-green-700 px-3 py-2 rounded-lg text-sm"><IconExcel /> Excel</button>
                                <button onClick={handleSaveImage} disabled={isGeneratingImg} className="btn-action bg-orange-50 text-orange-700 px-3 py-2 rounded-lg text-sm"><IconImage /> Image</button>
                                <button onClick={handlePrint} className="btn-action bg-blue-600 text-white px-3 py-2 rounded-lg text-sm"><IconPrinter /> Print</button>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
                            {/* Branch/Date Header (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) */}
                            <div className="bg-slate-800 p-6 text-white">
                                <div className="flex flex-col md:flex-row gap-6">
                                    <div className="flex-1">
                                        <label className="text-xs uppercase font-bold text-slate-400 block mb-1">Branch Name</label>
                                        <input type="text" name="branch" value={formData.branch} onChange={handleInputChange} placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤..." className="w-full bg-transparent border-b border-slate-600 text-xl py-1 focus:outline-none focus:border-blue-400 placeholder-slate-600 font-medium" />
                                    </div>
                                    <div className="flex gap-4">
                                        <div>
                                            <label className="text-xs uppercase font-bold text-slate-400 block mb-1">Date</label>
                                            <input type="date" name="date" value={formData.date} onChange={handleInputChange} className="bg-slate-700/50 rounded px-2 py-1 text-sm border border-slate-600 focus:outline-none" />
                                        </div>
                                        <div>
                                            <label className="text-xs uppercase font-bold text-slate-400 block mb-1">Time</label>
                                            <input type="time" name="time" value={formData.time} onChange={handleInputChange} className="bg-slate-700/50 rounded px-2 py-1 text-sm border border-slate-600 focus:outline-none" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="p-6 grid grid-cols-1 md:grid-cols-2 gap-8">
                                {/* Left Column: Sale Input */}
                                <div className="space-y-6">
                                    <div className="bg-blue-50/50 p-5 rounded-xl border border-blue-100">
                                        <h3 className="text-blue-800 font-bold mb-4 border-b border-blue-200 pb-2">Sale Information</h3>
                                        <div className="space-y-3">
                                            <div className="flex justify-between items-center">
                                                <span className="font-semibold text-gray-700">Total Sale (‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°)</span>
                                                <input type="number" name="totalSale" value={formData.totalSale} onChange={handleInputChange} onKeyDown={blockInvalidChar} placeholder="0.00" className="w-32 text-right p-1 border border-gray-300 rounded focus:border-blue-500 outline-none text-lg font-bold" />
                                            </div>
                                            
                                            {/* [MODIFIED] ‡πÄ‡∏û‡∏¥‡πà‡∏° Expenses ‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ */}
                                            <div className="flex justify-between items-center text-orange-700">
                                                <span className="font-semibold">Paid Out (‡∏ö‡∏¥‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å)</span>
                                                <input type="number" name="expenses" value={formData.expenses} onChange={handleInputChange} onKeyDown={blockInvalidChar} placeholder="0.00" className="w-32 text-right p-1 border border-orange-300 rounded focus:border-orange-500 outline-none font-bold bg-orange-50" />
                                            </div>

                                            <div className="flex justify-between items-center text-red-600">
                                                <span className="font-semibold">Return / Wrong Key</span>
                                                <input type="number" name="returnWrongKey" value={formData.returnWrongKey} onChange={handleInputChange} onKeyDown={blockInvalidChar} placeholder="0.00" className="w-32 text-right p-1 border border-red-300 rounded focus:border-red-500 outline-none font-bold text-red-600 bg-red-50" />
                                            </div>

                                            <div className="pt-3 border-t border-blue-200 space-y-2">
                                                {paymentMethods.map(label => (
                                                    <div key={label} className="flex justify-between items-center text-sm text-gray-600">
                                                        <span>{label}</span>
                                                        <input type="number" name={label.toLowerCase().replace(' ', '').replace('/', '')} value={formData[label.toLowerCase().replace(' ', '').replace('/', '')]} onChange={handleInputChange} onKeyDown={blockInvalidChar} className="w-24 text-right p-1 border border-gray-300 rounded focus:border-blue-400 outline-none" />
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Note Section */}
                                    <div className="bg-gray-50 p-5 rounded-xl border border-gray-200">
                                        <div className="mb-3">
                                            <label className="block font-bold text-gray-700 mb-1 text-sm">Recipient Name</label>
                                            <input type="text" name="recipient" value={formData.recipient} onChange={handleInputChange} className="w-full p-2 border border-gray-300 rounded" />
                                        </div>
                                        <div>
                                            <label className="block font-bold text-gray-700 mb-1 text-sm">Note</label>
                                            <textarea name="note" value={formData.note} onChange={handleInputChange} rows="2" className="w-full p-2 border border-gray-300 rounded resize-none text-sm"></textarea>
                                        </div>
                                    </div>
                                </div>

                                {/* Right Column: Money Count */}
                                <div className="bg-green-50/50 p-5 rounded-xl border border-green-100 h-full flex flex-col">
                                    <h3 className="text-green-800 font-bold mb-4 border-b border-green-200 pb-2">Money in Drawer</h3>
                                    <div className="flex-1 space-y-1">
                                        <DenomRow label="1,000" qtyName="qty1000" qtyValue={formData.qty1000} amount={calculations.breakdown.amt1000} onChange={handleInputChange} />
                                        <DenomRow label="500" qtyName="qty500" qtyValue={formData.qty500} amount={calculations.breakdown.amt500} onChange={handleInputChange} />
                                        <DenomRow label="100" qtyName="qty100" qtyValue={formData.qty100} amount={calculations.breakdown.amt100} onChange={handleInputChange} />
                                        <DenomRow label="50" qtyName="qty50" qtyValue={formData.qty50} amount={calculations.breakdown.amt50} onChange={handleInputChange} />
                                        <DenomRow label="20" qtyName="qty20" qtyValue={formData.qty20} amount={calculations.breakdown.amt20} onChange={handleInputChange} />
                                        <DenomRow label="10" qtyName="qty10" qtyValue={formData.qty10} amount={calculations.breakdown.amt10} onChange={handleInputChange} />
                                        <DenomRow label="‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç" qtyName="qty5" qtyValue={formData.qty5} amount={calculations.breakdown.amt5} onChange={handleInputChange} />
                                        <DenomRow label="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" qtyName="qty1" qtyValue={formData.qty1} amount={calculations.breakdown.amt1} onChange={handleInputChange} />
                                    </div>
                                    <div className="mt-4 pt-4 border-t-2 border-green-200">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="font-bold text-gray-700">Cash Real (‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ)</span>
                                            <span className="text-xl font-bold text-gray-900">{formatCurrency(calculations.totalCashReal)}</span>
                                        </div>
                                        {/* [MODIFIED] ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏≤‡πÅ‡∏ó‡∏ô Input */}
                                        <div className="flex justify-between items-center mb-3">
                                            <span className="text-gray-600 text-sm font-medium">Expected (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ)</span>
                                            <span className="text-lg font-bold text-blue-600">{formatCurrency(calculations.expectedCash)}</span>
                                        </div>
                                        <div className={`p-2 rounded border text-center font-bold ${calculations.overShort === 0 ? 'bg-gray-100 border-gray-300 text-gray-600' : calculations.overShort > 0 ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700'}`}>
                                            {calculations.overShort === 0 ? 'BALANCED (‡∏û‡∏≠‡∏î‡∏µ)' : calculations.overShort > 0 ? `OVER (+${formatCurrency(calculations.overShort)})` : `SHORT (${formatCurrency(calculations.overShort)})`}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="text-center text-xs text-gray-400 mt-8 mb-4">¬© Cash Drawer System (Updated)</div>
                    </div>

                    {/* [MODIFIED] ‡∏™‡πà‡∏ß‡∏ô Document Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Print/Image */}
                    <div id="document-template" className="hidden bg-white mx-auto w-[210mm] p-8 text-black" style={{ maxWidth: '800px' }}>
                         {/* Header */}
                         <div className="flex justify-between items-end border-b-2 border-black pb-2 mb-6">
                            <div className="flex-1 pr-8">
                                <div className="text-xs font-bold mb-1">‡∏™‡∏≤‡∏Ç‡∏≤ / Branch Name</div>
                                <div className="text-xl font-bold">{formData.branch || '_________________'}</div>
                            </div>
                            <div className="flex gap-8 text-right">
                                <div><div className="text-xs font-bold mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà / Date</div><div className="text-lg font-medium">{formData.date}</div></div>
                                <div><div className="text-xs font-bold mb-1">‡πÄ‡∏ß‡∏•‡∏≤ / Time</div><div className="text-lg font-medium">{formData.time}</div></div>
                            </div>
                        </div>
                        <div className="grid grid-cols-2 gap-6 h-full items-start">
                            <div className="flex flex-col gap-4">
                                <div className="border border-black p-4">
                                    <h2 className="text-lg font-bold border-b border-black pb-2 mb-3">Sale Summary</h2>
                                    <div className="space-y-2">
                                        <div className="flex justify-between"><span className="font-bold">Total Sale</span><span>{formData.totalSale}</span></div>
                                        <div className="flex justify-between text-red-600"><span className="font-bold">- Return/Wrong</span><span>{formData.returnWrongKey}</span></div>
                                        <div className="flex justify-between text-orange-600"><span className="font-bold">- Paid Out/Bills</span><span>{formData.expenses}</span></div>
                                        <div className="border-t border-gray-300 pt-2">
                                            {paymentMethods.map(l => formData[l.toLowerCase().replace(' ', '').replace('/', '')] > 0 && (
                                                <div key={l} className="flex justify-between text-sm text-gray-600"><span>- {l}</span><span>{formData[l.toLowerCase().replace(' ', '').replace('/', '')]}</span></div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div className="border border-black p-4 h-full">
                                <h2 className="text-lg font-bold border-b border-black pb-2 mb-2">Money Check</h2>
                                <div>
                                    <DocDenomRow label="1,000" qty={formData.qty1000} amount={calculations.breakdown.amt1000} />
                                    <DocDenomRow label="500" qty={formData.qty500} amount={calculations.breakdown.amt500} />
                                    <DocDenomRow label="100" qty={formData.qty100} amount={calculations.breakdown.amt100} />
                                    <DocDenomRow label="Total" qty="" amount={calculations.totalCashReal} />
                                </div>
                                <div className="border-t-2 border-black mt-3 pt-3">
                                    <div className="flex justify-between mb-2"><span className="font-bold">Counted (‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ)</span><span className="font-bold text-xl">{formatCurrency(calculations.totalCashReal)}</span></div>
                                    <div className="flex justify-between mb-2 text-gray-600"><span className="font-medium">Expected (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ)</span><span>{formatCurrency(calculations.expectedCash)}</span></div>
                                    <div className="border-2 border-black p-2 rounded text-center">
                                        <div className="font-bold text-lg uppercase">{calculations.overShort === 0 ? 'BALANCED' : calculations.overShort > 0 ? 'OVER (+)' : 'SHORT (-)'}</div>
                                        <div className="font-mono text-2xl font-bold">{formatCurrency(Math.abs(calculations.overShort))}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
   
</body>
</html>
